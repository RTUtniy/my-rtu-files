clc, clearvars,format compact, close all                 % notīra komandu logu, izdzēš visas mainīgās, kompaktāks izvads, aizver visas figūras

xpoints=[0:0.25:2];                                      % x vērtības ar soli 0.25 (datu punkti)
ypoints=[20.00 51.58 68.73 75.46 74.36 67.09 54.73 37.98 17.28]; % y vērtības (funkcijas vērtības tabulā)

plot(xpoints,ypoints,'or','LineWidth',3)                 % uzzīmē sākotnējos datu punktus (sarkani aplīši)
grid on                                                  % ieslēdz režģi
title('Datu punkti')                                     % grafika virsraksts

p = polyfit(xpoints,ypoints,1)                           % atrod 1. kārtas (lineārā) polinoma koeficientus
xapprox = 0:0.01:2; yapprox = polyval(p,xapprox);         % izveido blīvu x režģi un aprēķina polinoma vērtības

figure                                                   % atver jaunu figūru
plot(xpoints,ypoints,'or',xapprox,yapprox,'k','LineWidth',3) % uzzīmē datu punktus un lineāro aproksimāciju
legend('datu punkti','polinoms')                         % leģenda
title('Aproksimācija ar pirmās kārtas polinomu'),grid on % virsraksts un režģis
fun_prob1(p)                                             % izdrukā polinomu pēc atrastajiem koeficientiem

% ----- Aproksimācija ar 2. kārtas polinomu -----
p = polyfit(xpoints,ypoints,2), yapprox = polyval(p,xapprox); % atrod 2. kārtas polinomu un tā vērtības
figure                                                   % jauna figūra
plot(xpoints,ypoints,'or',xapprox,yapprox,'k','LineWidth',3) % datu punkti un kvadrātiskais polinoms
legend('datu punkti','polinoms')                         % leģenda
title('Aproksimācija ar otrās kārtas polinomu')          % virsraksts
grid on                                                  % režģis
fun_prob1(p)                                             % izdrukā 2. kārtas polinomu

p = polyfit(xpoints,ypoints,3)                           % atrod 3. kārtas polinomu
xapprox = 0:0.01:2; yapprox = polyval(p,xapprox);         % aprēķina polinoma vērtības jaunajā režģī
figure                                                   % jauna figūra
plot(xpoints,ypoints,'or',xapprox,yapprox,'k','LineWidth',3) % datu punkti un kubiskais polinoms
legend('datu punkti','polinoms')                         % leģenda
title('Aproksimācija ar 3.kārtas polinomu'),grid on      % virsraksts un režģis
fun_prob1(p)                                             % izdrukā 3. kārtas polinomu

p = polyfit(xpoints,ypoints,4)                           % atrod 4. kārtas polinomu
xapprox = 0:0.01:2; yapprox = polyval(p,xapprox);         % aprēķina 4. kārtas polinomu
figure                                                   % jauna figūra
plot(xpoints,ypoints,'or',xapprox,yapprox,'k','LineWidth',3) % datu punkti un 4. kārtas polinoms
legend('datu punkti','polinoms')                         % leģenda
title('Aproksimācija ar 4.kārtas polinomu'),grid on      % virsraksts un režģis
fun_prob1(p)                                             % izdrukā 4. kārtas polinomu

% ===== Funkcija polinoma izdrukāšanai =====
function fun_prob1(koef)
m = length(koef);                                        % koeficientu skaits (polinoma kārta + 1)
fprintf('\n Atbilde. %.0f.kārtas polinoms: \n ',m-1)     % izvada polinoma kārtu
n = m-1;                                                 % sākam drukāt no augstākās pakāpes
for i = 1:m                                              % ejam cauri visiem koeficientiem
    if koef(i) < 0                                       % ja koeficients negatīvs – mīnuss jau ir klāt
        fprintf(' %.4fx^%.0f',koef(i),n)                 % izdrukā terminu ar negatīvu koeficientu
    else                                                 % ja koeficients pozitīvs
        fprintf(' +')                                    % pievieno plusa zīmi
        fprintf('%.4fx^%.0f',koef(i),n)                  % izdrukā terminu ar pozitīvu koeficientu
    end
    n = n-1;                                             % samazina pakāpi par 1
end
fprintf('\n')                                            % pāreja jaunā rindā pēc polinoma
end
